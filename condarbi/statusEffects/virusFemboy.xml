<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<statusEffect>
  <renderingPriority>75</renderingPriority>
  <renderInEffectsPanel>true</renderInEffectsPanel>
  <category>DEFAULT</category>
  <beneficial>NEUTRAL</beneficial>
  <combatEffect>false</combatEffect>
  <sexEffect>true</sexEffect>
  <tags/>
  <name><![CDATA[Femboy Virus]]></name>
  <description><![CDATA[
    [npc.HeSheHasFull()] the Femboy Virus and will quickly [npc.colorTfGeneric(transform into a femboy)] and [npc.glowTfGeneric(spread the virus to others through sexual contact.)]
  ]]></description>
  <imageName>virus.svg</imageName>
  <colourPrimary>BASE_BLUE_LIGHT</colourPrimary>
  <colourSecondary/>
  <colourTertiary/>
  <attributeModifiers/>
  <combatMoves/>
  <spells/>
  <extraEffects/>
  <applicationCondition><![CDATA[false]]></applicationCondition>
  <applicationLength constantRefresh="false">-1</applicationLength>
  <applyEffect><![CDATA[
    #IF(game.isInSex() && npc == sex.getCharacterOrgasming() && sex.isReadyToOrgasm(npc))
      [## function infect(partner) {
        partner.addStatusEffect(SE_condarbi_virusFemboy, 86400);
      }]
      [## function getPartners(characterMap) {
        characterMap.remove(npc);
        characterMap.keySet().forEach(infect);
      }]
      [##sex.getOngoingActionsMap(npc).values().stream().forEach(getPartners)]
    #ENDIF
  ]]></applyEffect>
  <applyRemovalEffect/>
  <applyPostRemovalEffect><![CDATA[
    [## npc.addStatusEffect(SE_condarbi_virusFemboy, 86400)]
    [## function transform(npc, stat, target, lowerBound, upperBound, desiredTime, onInfection) {
      var output = "";
      switch(stat.toLowerCase().replace(/_/g, "")) {
        case 'asssize':
          var statObj = {
            get : function() {
              return npc.getAssSize().getValue();
            },
            set : function(i) {
              output += npc.setAssSize(i);
            },
            increment : function(i) {
              output += npc.incrementAssSize(i);
            },
            max : 7,
            min: 0
          };
          break;
      }
      statObj.increment(1);
      return output;
    }]
    [# transform(npc, "assSize", 1, 2, 3, 4, 5)]
  ]]></applyPostRemovalEffect>
</statusEffect>
